var Clickable=function(c,b){function a(){a._enableClicking.apply(this,arguments)}a.touchable=function(){return a._os.touchable};a.sticky=function(){a._enableStickyClick.apply(this,arguments)};if(b&&b.fn){b.fn.clickable=function(d){this.each(function(){a._enableClicking(this,d)});return this};b.fn.stickyClick=function(d){this.each(function(){a._enableStickyClick(this,d)});return this}}if(c&&c.fn){c.extend(c.fn,{clickable:function(d){this.forEach(function(e){a._enableClicking(e,d)});return this},stickyClick:function(d){this.forEach(function(e){a._enableStickyClick(e,d)});return this}})}return a}(window.Zepto,window.jQuery);Clickable._os=function(f,d){var c,a,b;if(b=/\bCPU.*OS (\d+(_\d+)?)/i.exec(f)){c="ios";a=b[1].replace("_",".")}else{if(b=/\bAndroid (\d+(\.\d+)?)/.exec(f)){c="android";a=b[1]}}var e={name:c,version:a&&d(a),touchable:!!c};e[c]=true;return e}(navigator.userAgent,parseFloat);Clickable._trimString=function(a){var b=/^\s+|\s+$/g;return function(c){return a(c).replace(b,"")}}(String);Clickable._isDOMNode=function(a,b){return function(d){if(!d){return false}try{return(d instanceof a)||(d instanceof b)}catch(c){}if(typeof d!=="object"){return false}if(typeof d.nodeType!=="number"){return false}if(typeof d.nodeName!=="string"){return false}return true}}(Node,HTMLElement);Clickable._isInDOM=function(){return function(a){while(a=a.parentNode){if(a===document){return true}}return false}}();Clickable._bindEvents=function(){return function(c,b){for(var a in b){if(c.addEventListener){c.addEventListener(a,b[a],false)}else{if(c.attachEvent){c.attachEvent("on"+a,b[a])}}}}}();Clickable._unbindEvents=function(){return function(c,b){for(var a in b){if(c.removeEventListener){c.removeEventListener(a,b[a])}}}}();Clickable._addClass=function(){return function(b,a){b.className+=" "+a}}();Clickable._removeClass=function(a){return function(c,b){c.className=a(c.className.replace(new RegExp("\\b"+b+"\\b"),""))}}(Clickable._trimString);Clickable._enableClicking=function(h,o,a,f,c,k,n){var i="active",m="data-clickable-class",g=40;var p=false,l=!!h.ios;function b(I,L){if(!o(I)){throw TypeError("element "+I+" must be a DOM element")}if(I._clickable){return}I._clickable=true;switch(typeof L){case"undefined":L=i;break;case"string":break;default:throw TypeError("active class "+L+" must be a string")}var E=false,q=false,G,H,s;I.setAttribute(m,L);I.style["-webkit-tap-highlight-color"]="rgba(255,255,255,0)";v();return;function J(){E=true;G=+new Date();H=j(I);if(H){s=H.scrollTop;H.addEventListener("scroll",A,true)}}function F(){if(H){H.removeEventListener("scroll",A)}H=null;s=null;E=false}function A(){B()}function M(){return E}function t(){k(I,L)}function r(){n(I,L)}function v(){f(I,{click:x});if(!h.touchable){f(I,{mousedown:C,mousemove:D,mouseout:D,mouseup:z});return}if(h.ios){f(I,{DOMNodeInsertedIntoDocument:K,DOMNodeRemovedFromDocument:y});if(a(I)){K()}}else{K()}}function K(){f(I,{touchstart:w,touchmove:B,touchcancel:B,touchend:u})}function y(){c(I,{touchstart:w,touchmove:B,touchcancel:B,touchend:u})}function x(N){N=N||window.event;if(!I.disabled&&q){q=false;setTimeout(function(){p=false},0)}else{if(N.stopImmediatePropagation){N.stopImmediatePropagation()}N.preventDefault();N.stopPropagation();N.cancelBubble=true;N.returnValue=false;return false}}function C(N){q=false;if(I.disabled||!e(N.target,I)){N.preventDefault();F();return}J();t()}function D(N){N.preventDefault();F();q=false;r()}function z(N){if(I.disabled){N.preventDefault();F();q=false;return}if(!M()){N.preventDefault();q=false}else{q=true}F();r()}function w(N){q=false;if(p||I.disabled||(N.touches.length!==1)||!e(N.target,I)){F();return}p=true;J();if(H){if(H._isScrolling||(s<0)||(H.scrollHeight<s)){F();return}}var O=G;setTimeout(function(){if(M()&&(O===G)){t()}},g)}function B(N){q=false;F();if(N){p=false}if(I.disabled){return}r()}function u(R){var N=M(),O=H,P=s;B();if(!N||I.disabled){p=false;return}if(O){if(O._isScrolling||(O.scrollTop!==P)){return}}if(!R.stopImmediatePropagation){q=true;return}var Q=+new Date()-G;if(Q>g){q=true;d(I)}else{t();setTimeout(function(){r();q=true;d(I)},1)}}}function e(r,q){do{if(r===q){return true}else{if(r._clickable){return false}}}while(r=r.parentNode);return false}function d(r){var q=document.createEvent("MouseEvents");q.initMouseEvent("click",true,true,window,1,0,0,0,0,false,false,false,false,0,null);r.dispatchEvent(q)}function j(q){if(!h.ios||(h.version<5)){return}while(q=q.parentNode){if(q._scrollable){if(q._iScroll){return}return q}}}return b}(Clickable._os,Clickable._isDOMNode,Clickable._isInDOM,Clickable._bindEvents,Clickable._unbindEvents,Clickable._addClass,Clickable._removeClass);Clickable._enableStickyClick=function(a,c,f){var d="data-clickable-class";function e(i,h,g){if(!c(i)){throw TypeError("button must be a DOM element, got "+i)}switch(typeof h){case"string":break;case"function":g=h;h=undefined;break;default:throw TypeError("button active class must be a string if defined, got "+h)}if(typeof g!=="function"){throw TypeError("sticky click handler must be a function, got "+g)}f(i,h);i.addEventListener("click",b(i,g),false)}function b(h,g){return function(){var j=false,i=h.getAttribute(d),m;h.disabled=true;h.className+=" "+i;try{m=g(l)}catch(k){if(window.console&&window.console.error){window.console.error(k+"")}l()}if(m===false){l()}function l(){if(j){return}j=true;if(h.disabled){h.disabled=false;h.className=a(h.className.replace(new RegExp("\\b"+i+"\\b","g"),""))}}}}return e}(Clickable._trimString,Clickable._isDOMNode,Clickable._enableClicking);
